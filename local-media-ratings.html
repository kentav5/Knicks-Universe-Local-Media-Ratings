<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Knicks Universe â€“ Local NYC Media Ratings</title>
  <meta name="description" content="Fan voting â€” rate local NYC Knicks media personalities 10 (GOAT) to 1 (Trash). Votes stored via Google Forms without leaving the page." />

  <style>
    :root{
      --knicks-blue:#006BB6;
      --knicks-orange:#F58426;
      --bg:#0b1020;
      --card:#0f172a;
      --card2:#111c34;
      --text:#f8fafc;
      --muted:#a7b0c0;
      --border:rgba(148,163,184,.22);
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --success:#18a957;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(0,107,182,.25), transparent 55%),
        radial-gradient(900px 500px at 85% 15%, rgba(245,132,38,.18), transparent 55%),
        var(--bg);
      color:var(--text);
    }

    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:18px 16px 70px;
    }

    /* Top Nav (match your other pages) */
    .nav{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:10px 0 16px;
      border-bottom:1px solid var(--border);
      margin-bottom:14px;
    }
    .nav-left{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .nav-logo{
      width:34px;height:34px;border-radius:10px;
      background:linear-gradient(135deg, rgba(0,107,182,.95), rgba(245,132,38,.92));
      box-shadow:0 10px 20px rgba(0,0,0,.25);
      flex:0 0 auto;
    }
    .nav-title{
      font-weight:950;
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .nav-links{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .nav a{
      text-decoration:none;
      color:var(--text);
      font-weight:900;
      font-size:.9rem;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background:rgba(2,6,23,.22);
      transition:transform .12s ease, border-color .12s ease;
    }
    .nav a:hover{
      transform:translateY(-1px);
      border-color:rgba(245,132,38,.45);
    }
    .nav a.active{
      border-color:var(--knicks-orange);
      box-shadow:0 0 0 2px rgba(245,132,38,.22);
    }

    header{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:18px;
      flex-wrap:wrap;
      padding:10px 0 18px;
      border-bottom:1px solid var(--border);
      margin-bottom:18px;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .brand h1{
      margin:0;
      font-size:1.6rem;
      letter-spacing:.2px;
    }
    .brand p{
      margin:0;
      color:var(--muted);
      font-size:.95rem;
      line-height:1.35;
      max-width:760px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:14px;
      background:rgba(15,23,42,.7);
      box-shadow:var(--shadow);
      font-weight:800;
      font-size:.9rem;
      white-space:nowrap;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background:var(--knicks-orange);
      box-shadow:0 0 0 4px rgba(245,132,38,.22);
    }

    /* Sort bar */
    .sortbar{
      margin-top:12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .sortbar-label{
      color:var(--muted);
      font-size:.9rem;
      font-weight:800;
    }
    .sortbtn{
      padding:8px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background:rgba(15,23,42,.82);
      color:var(--text);
      cursor:pointer;
      font-weight:900;
      font-size:.85rem;
      transition:transform .12s ease;
    }
    .sortbtn:hover{ transform:translateY(-1px); }
    .sortbtn.active{
      border-color:var(--knicks-orange);
      box-shadow:0 0 0 2px rgba(245,132,38,.25);
    }

    /* Cards */
    .cards-grid{
      display:grid;
      grid-template-columns:repeat(3, minmax(0, 1fr));
      gap:16px;
      margin-top:14px;
    }
    @media (max-width: 980px){
      .cards-grid{ grid-template-columns:repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 620px){
      .cards-grid{ grid-template-columns:1fr; }
    }

    .card{
      border:1px solid var(--border);
      border-radius:18px;
      background:linear-gradient(180deg, rgba(17,28,52,.98), rgba(15,23,42,.98));
      box-shadow:var(--shadow);
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      position:relative;
      overflow:hidden;
    }

    .imgwrap{
      border-radius:14px;
      background:rgba(2,6,23,.28);
      border:1px solid rgba(148,163,184,.14);
      overflow:hidden;
      aspect-ratio: 4 / 3;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .imgwrap img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .placeholder{
      width:100%;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      color:rgba(248,250,252,.85);
      font-weight:900;
      letter-spacing:.3px;
      background:
        radial-gradient(500px 220px at 20% 20%, rgba(0,107,182,.25), transparent 55%),
        radial-gradient(500px 220px at 80% 30%, rgba(245,132,38,.18), transparent 55%),
        rgba(2,6,23,.22);
    }

    .name{
      margin:2px 0 0;
      font-weight:950;
      font-size:1.02rem;
      letter-spacing:.2px;
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      color:var(--muted);
      font-weight:800;
      font-size:.9rem;
      margin-top:-2px;
    }
    .pill{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(2,6,23,.22);
      white-space:nowrap;
    }

    label{
      color:var(--muted);
      font-weight:900;
      font-size:.88rem;
    }

    select{
      width:100%;
      border-radius:12px;
      padding:10px 12px;
      border:1px solid rgba(148,163,184,.22);
      background:rgba(2,6,23,.28);
      color:var(--text);
      font-weight:850;
      outline:none;
    }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:10px 14px;
      border-radius:14px;
      font-weight:950;
      text-decoration:none;
      border:1px solid rgba(148,163,184,.18);
      color:var(--text);
      background:rgba(2,6,23,.25);
      cursor:pointer;
      transition:transform .12s ease, border-color .12s ease, opacity .12s ease;
    }
    .btn:hover{
      transform:translateY(-1px);
      border-color:rgba(245,132,38,.45);
    }
    .btn.primary{
      border:0;
      color:#071018;
      background:linear-gradient(90deg, rgba(0,107,182,.95), rgba(245,132,38,.92));
      box-shadow:0 10px 20px rgba(0,0,0,.28);
    }
    .btn[disabled]{ opacity:.6; cursor:default; transform:none; }

    .confirm{
      display:none;
      margin-top:4px;
      color:rgba(24,169,87,.95);
      font-weight:950;
      font-size:.9rem;
    }
    .confirm.show{ display:block; }

    footer{
      margin-top:18px;
      color:var(--muted);
      font-size:.85rem;
      line-height:1.35;
      padding-top:14px;
      border-top:1px solid var(--border);
    }

    /* small helper */
    .tiny{ font-size:.82rem; color:var(--muted); margin-top:6px; }
  </style>
</head>

<body>
  <div class="wrap">

    <nav class="nav">
      <div class="nav-left">
        <div class="nav-logo" aria-hidden="true"></div>
        <div class="nav-title">Knicks Universe</div>
      </div>
      <div class="nav-links">
        <a href="https://kentav5.github.io/Knicks-Universe-Media-Ratings/media-ratings.html">National Media</a>
        <a class="active" href="#">Local NYC Media</a>
        <a href="https://kentav5.github.io/Knicks-Universe---Player-Polls/ratings.html" target="_blank" rel="noopener">Player Ratings</a>
      </div>
    </nav>

    <!-- Hidden target so Googleâ€™s response doesnâ€™t navigate away -->
    <iframe name="ku_hidden_submit" style="display:none;"></iframe>

    <header>
      <div class="brand">
        <h1>Knicks Universe â€“ Local NYC Media Ratings</h1>
        <p>Rate local NYC Knicks media personalities from <strong>GOAT (10)</strong> to <strong>Trash (1)</strong>. Your vote updates the live averages.</p>

        <div class="sortbar">
          <span class="sortbar-label">Sort:</span>
          <button class="sortbtn active" type="button" data-sort="rating">Highest Rated</button>
          <button class="sortbtn" type="button" data-sort="votes">Most Votes</button>
          <button class="sortbtn" type="button" data-sort="az">Aâ€“Z</button>
        </div>

        <div class="tiny">
          Note: Live averages require your Google Sheet to be published (View-only). If not published yet, cards will show â€œâ€”â€.
        </div>
      </div>

      <div class="badge"><span class="dot"></span> Live fan voting</div>
    </header>

    <div class="cards-grid" id="cardsGrid">

      <!-- Ian Begley -->
      <form class="card" data-name="Ian Begley" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap">
          <div class="placeholder">IAN BEGLEY</div>
        </div>
        <div class="name">Ian Begley</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="begley">Your rating:</label>
        <select id="begley" name="entry.815230096" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option>
          <option>9 â€“ Elite â­ï¸</option>
          <option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option>
          <option>6 â€“ Solid ğŸ”„</option>
          <option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option>
          <option>3 â€“ Poor ğŸª‘</option>
          <option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Ian Begley was recorded.</div>
      </form>

      <!-- Bill Pidto -->
      <form class="card" data-name="Bill Pidto" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">BILL PIDTO</div></div>
        <div class="name">Bill Pidto</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="pidto">Your rating:</label>
        <select id="pidto" name="entry.1467333831" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Bill Pidto was recorded.</div>
      </form>

      <!-- Wally Szczerbiak -->
      <form class="card" data-name="Wally Szczerbiak" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">WALLY SZCZERBIAK</div></div>
        <div class="name">Wally Szczerbiak</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="wally">Your rating:</label>
        <select id="wally" name="entry.2145553835" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Wally Szczerbiak was recorded.</div>
      </form>

      <!-- Alana Hahn -->
      <form class="card" data-name="Alana Hahn" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">ALANA HAHN</div></div>
        <div class="name">Alana Hahn</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="alana">Your rating:</label>
        <select id="alana" name="entry.228026217" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Alana Hahn was recorded.</div>
      </form>

      <!-- Monica McNutt -->
      <form class="card" data-name="Monica McNutt" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">MONICA McNUTT</div></div>
        <div class="name">Monica McNutt</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="monica">Your rating:</label>
        <select id="monica" name="entry.1316754163" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Monica McNutt was recorded.</div>
      </form>

      <!-- Stefan Bondy -->
      <form class="card" data-name="Stefan Bondy" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">STEFAN BONDY</div></div>
        <div class="name">Stefan Bondy</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="bondy">Your rating:</label>
        <select id="bondy" name="entry.1387740233" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Stefan Bondy was recorded.</div>
      </form>

      <!-- Peter Botte -->
      <form class="card" data-name="Peter Botte" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">PETER BOTTE</div></div>
        <div class="name">Peter Botte</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="botte">Your rating:</label>
        <select id="botte" name="entry.1463574973" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Peter Botte was recorded.</div>
      </form>

      <!-- Kristian Winfield -->
      <form class="card" data-name="Kristian Winfield" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">KRISTIAN WINFIELD</div></div>
        <div class="name">Kristian Winfield</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="winfield">Your rating:</label>
        <select id="winfield" name="entry.1036744431" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Kristian Winfield was recorded.</div>
      </form>

      <!-- Steve Popper -->
      <form class="card" data-name="Steve Popper" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">STEVE POPPER</div></div>
        <div class="name">Steve Popper</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="popper">Your rating:</label>
        <select id="popper" name="entry.350331188" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Steve Popper was recorded.</div>
      </form>

      <!-- James Edwards III -->
      <form class="card" data-name="James Edwards III" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">JAMES EDWARDS III</div></div>
        <div class="name">James Edwards III</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="edwards">Your rating:</label>
        <select id="edwards" name="entry.48419644" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for James Edwards III was recorded.</div>
      </form>

      <!-- Mike Lupica -->
      <form class="card" data-name="Mike Lupica" data-avg="0" data-votes="0"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfRGkT97wB7zQ4V2jlwnctsrQhtVYOYibBsYYDScwDhMPLenA/formResponse"
        method="POST" target="ku_hidden_submit">
        <div class="imgwrap"><div class="placeholder">MIKE LUPICA</div></div>
        <div class="name">Mike Lupica</div>
        <div class="meta">
          <span class="pill avg">Avg: <strong>â€”</strong></span>
          <span class="pill votes">Votes: <strong>â€”</strong></span>
        </div>
        <label for="lupica">Your rating:</label>
        <select id="lupica" name="entry.594500527" required>
          <option value="" disabled selected>Select your rating</option>
          <option>10 â€“ GOAT ğŸ</option><option>9 â€“ Elite â­ï¸</option><option>8 â€“ Excellent ğŸ”¥</option>
          <option>7 â€“ Very Good ğŸ’ª</option><option>6 â€“ Solid ğŸ”„</option><option>5 â€“ Average ğŸŸ°</option>
          <option>4 â€“ Below Average ğŸ’¤</option><option>3 â€“ Poor ğŸª‘</option><option>2 â€“ Bad ğŸŒ´</option>
          <option>1 â€“ Trash ğŸ—‘ï¸</option>
        </select>
        <button class="btn primary" type="submit">Submit Vote</button>
        <div class="confirm">Thanks! Your vote for Mike Lupica was recorded.</div>
      </form>

    </div>

    <footer>
      Â© KnicksUniverse.com â€” voting is anonymous. Results are aggregated in a Google Sheet connected to your Google Form.
    </footer>
  </div>

  <script>
    // ========= CONFIG: You MUST update these two =========
    // Open your response spreadsheet, copy the Sheet ID from the URL:
    // https://docs.google.com/spreadsheets/d/<SHEET_ID>/edit...
    //
    // Then get the gid for the "Form Responses 1" tab (from URL "gid=12345").
    const SHEET_ID  = "REPLACE_WITH_YOUR_SHEET_ID";
    const SHEET_GID = "REPLACE_WITH_YOUR_FORM_RESPONSES_GID";
    // ====================================================

    const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?gid=${SHEET_GID}&tqx=out:json`;

    // We compute per-person: avg score + votes count (same logic as your Player page)
    const IGNORE_HEADERS = new Set(["Timestamp"]);

    function normalizeHeader(raw){
      if (!raw) return "";
      let h = String(raw).trim();
      h = h.replace(/\s+/g, " ");
      return h;
    }

    function parseGviz(text){
      const start = text.indexOf("{");
      const end = text.lastIndexOf("}");
      if (start === -1 || end === -1) throw new Error("Unexpected sheet response format");
      return JSON.parse(text.substring(start, end + 1));
    }

    function getNameFromCard(card){
      return (card.dataset.name || "").trim();
    }

    function setAvgAndVotesOnCard(card, avg, votes){
      card.dataset.avg = String(avg || 0);
      card.dataset.votes = String(votes || 0);

      const avgPill = card.querySelector(".pill.avg strong");
      const votesPill = card.querySelector(".pill.votes strong");
      if (avgPill) avgPill.textContent = (votes ? avg.toFixed(1) : "â€”");
      if (votesPill) votesPill.textContent = (votes ? String(votes) : "â€”");
    }

    // Sorting
    let currentSortMode = "rating";
    function sortCards(mode){
      currentSortMode = mode;
      const grid = document.getElementById("cardsGrid");
      if (!grid) return;

      const cards = Array.from(grid.querySelectorAll(".card"));
      cards.sort((a,b)=>{
        const aAvg = parseFloat(a.dataset.avg || "0");
        const bAvg = parseFloat(b.dataset.avg || "0");
        const aVotes = parseInt(a.dataset.votes || "0", 10);
        const bVotes = parseInt(b.dataset.votes || "0", 10);

        if (mode === "votes"){
          if (bVotes !== aVotes) return bVotes - aVotes;
          return bAvg - aAvg;
        }
        if (mode === "az"){
          return getNameFromCard(a).localeCompare(getNameFromCard(b));
        }
        // rating
        if (bAvg !== aAvg) return bAvg - aAvg;
        if (bVotes !== aVotes) return bVotes - aVotes;
        return getNameFromCard(a).localeCompare(getNameFromCard(b));
      });

      cards.forEach(c => grid.appendChild(c));
    }

    function initSortButtons(){
      const btns = document.querySelectorAll(".sortbtn");
      btns.forEach(btn=>{
        btn.addEventListener("click", ()=>{
          btns.forEach(b=>b.classList.remove("active"));
          btn.classList.add("active");
          sortCards(btn.dataset.sort);
        });
      });
    }

    // Load + compute
    async function loadLocalMediaFromSheet(){
      // If config not updated, do nothing (page still works for voting).
      if (!SHEET_ID || SHEET_ID.includes("REPLACE_") || !SHEET_GID || String(SHEET_GID).includes("REPLACE_")){
        return;
      }

      try{
        const resp = await fetch(SHEET_URL);
        const text = await resp.text();
        const data = parseGviz(text);

        const cols = data.table.cols || [];
        const rows = data.table.rows || [];

        const sums = {};
        const counts = {};

        rows.forEach(row=>{
          const cells = row.c || [];
          for (let colIndex = 0; colIndex < cols.length; colIndex++){
            const colMeta = cols[colIndex];
            if (!colMeta) continue;

            const header = normalizeHeader(colMeta.label);
            if (!header || IGNORE_HEADERS.has(header)) continue;

            // Only process columns that match one of our card names
            const cardName = header; // header is the question title in the Form
            const card = document.querySelector(`.card[data-name="${CSS.escape(cardName)}"]`);
            if (!card) continue;

            const cell = cells[colIndex];
            if (!cell || cell.v == null) continue;

            const rawVal = String(cell.v);
            // Extract number from "10 â€“ GOAT ğŸ"
            const numVal = Number(rawVal.replace(/[^\d.]/g, ""));
            if (isNaN(numVal)) continue;

            if (!sums[cardName]) { sums[cardName] = 0; counts[cardName] = 0; }
            sums[cardName] += numVal;
            counts[cardName] += 1;
          }
        });

        // Apply to cards
        const cards = Array.from(document.querySelectorAll(".card"));
        cards.forEach(card=>{
          const name = getNameFromCard(card);
          const votes = counts[name] || 0;
          const avg = votes ? (sums[name] / votes) : 0;
          setAvgAndVotesOnCard(card, avg, votes);
        });

        sortCards(currentSortMode);
      } catch(err){
        console.error("Local Media: error loading sheet averages", err);
      }
    }

    // Inline confirmation (no page navigation)
    (function(){
      document.querySelectorAll(".card").forEach(form=>{
        const select = form.querySelector("select");
        const button = form.querySelector("button[type='submit']");
        const confirm = form.querySelector(".confirm");

        form.addEventListener("submit", ()=>{
          if (button) button.disabled = true;
          if (confirm) confirm.classList.add("show");

          setTimeout(()=>{
            if (button) button.disabled = false;
            if (select) select.selectedIndex = 0;
          }, 1400);

          // refresh numbers shortly after submit
          setTimeout(loadLocalMediaFromSheet, 2000);
        });
      });
    })();

    document.addEventListener("DOMContentLoaded", ()=>{
      initSortButtons();
      loadLocalMediaFromSheet();
    });

    // Optional: auto-refresh every 30 seconds like your national page
    setInterval(loadLocalMediaFromSheet, 30000);
  </script>
</body>
</html>
